includeConfigs:
  - ${DRP_PIPE_DIR}/bps/resources/LSSTCam/DRP.yaml

LSST_VERSION: w_2025_43

pipelineYaml: "${PWD}/LSSTCam_coadd_pipeline.yaml#coadd_pipeline_steps"

payload:
  payloadName: coadd_pipeline_test_{LSST_VERSION}
  butlerConfig: /repo/main
  inCollection: LSSTCam/defaults
  dataQuery: "instrument='LSSTCam' and skymap='lsst_cells_v1' and day_obs=20250904 and exposure.observation_type='science' and band='i' and detector < 189 and detector not in (0, 20, 27, 65, 123, 161, 168, 188, 122, 169, 187, 120, 158, 30, 68, 1, 19)"

numberOfRetries: 3
requestMemory: 4000
memoryMultiplier: 2
extraQgraphOptions: "--dataset-query-constraint raw"
extraRunQuantumOptions: "--no-raise-on-partial-outputs"

wmsServiceClass: lsst.ctrl.bps.parsl.ParslService
computeSite: work_queue

parsl:
  log_level: WARN

site:
  local:
    class: lsst.ctrl.bps.parsl.sites.Local
    cores: 8
    monitorEnable: true
    monitorFilename: runinfo/monitoring.db
  work_queue:
    class: bps_parsl_sites.SlurmWorkQueue
    nodes_per_block: 5
    walltime: "2:00:00"
    exclusive: true
    scheduler_options: |
      #SBATCH --partition=milano
    worker_options: "--memory=440000"  # total memory in MB
    monitorEnable: true
    monitorFilename: runinfo/monitoring.db
